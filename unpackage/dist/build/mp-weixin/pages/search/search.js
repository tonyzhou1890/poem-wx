(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"0dd2":function(t,e,n){"use strict";var a={"search-bar":function(){return n.e("components/search-bar/search-bar").then(n.bind(null,"3803"))},"cl-tabs":function(){return Promise.all([n.e("common/vendor"),n.e("components/cl-tabs/cl-tabs")]).then(n.bind(null,"9ffe"))},"poem-list":function(){return n.e("components/poem-list/poem-list").then(n.bind(null,"cff9"))},"uni-load-more":function(){return n.e("components/uni-load-more/uni-load-more").then(n.bind(null,"404f"))}},o=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}))},"0ffa":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2df2"),o=n("b4a2"),i=function(){n.e("components/search-bar/search-bar").then(function(){return resolve(n("3803"))}.bind(null,n)).catch(n.oe)},r=function(){n.e("components/empty/empty").then(function(){return resolve(n("3df6"))}.bind(null,n)).catch(n.oe)},s=function(){Promise.all([n.e("common/vendor"),n.e("components/cl-tabs/cl-tabs")]).then(function(){return resolve(n("9ffe"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/poem-list/poem-list").then(function(){return resolve(n("cff9"))}.bind(null,n)).catch(n.oe)},l={components:{SearchBar:i,Empty:r,ClTabs:s,PoemList:c},data:function(){return{showHistory:!1,historyList:[],tabs:["作者","标题","诗词"],tabIndex:-1,mainColor:a.mainColor,loading:!1,rows:20,page:0,total:0,data:[],isAll:!1,bgc:""}},methods:{handleStatusChange:function(e){this.showHistory=e.value,this.showHistory&&(this.historyList=t.getStorageSync(a.storageKeys.search)||[])},handleConfirm:function(e,n){var o=e.value&&e.value.trim();if(o){var i=t.getStorageSync(a.storageKeys.search);i=Array.isArray(i)?i:[],i.indexOf(o)>-1&&i.splice(i.indexOf(o),1),i.unshift(o),i=i.slice(0,10);try{t.setStorageSync(a.storageKeys.search,i)}catch(r){console.log(r)}n&&this.$refs.searchBar.setInputText(e.value),this.tabIndex=0,this.poemList(!0)}else t.showToast({icon:"none",title:"没有搜索内容"})},handleClearHistory:function(){try{t.setStorageSync(a.storageKeys.search,[]),this.historyList=[]}catch(e){console.log(e)}},handleTabChange:function(t){this.tabIndex=t,this.poemList(!0)},handleClickPoem:function(e){t.navigateTo({url:"../article/article?id="+e._id})},handleScrollToLower:function(){this.poemList()},poemList:function(t){var e=this;if(!this.loading&&(t&&(this.total=0,this.isAll=!1,this.page=0,this.data=[]),!this.isAll)){var n="";switch(this.tabIndex){case 0:n="author";break;case 1:n="title";break;case 2:n="content";break}n&&(this.loading=!0,(0,o.search)({page:this.page+1,rows:this.rows,keyword:this.$refs.searchBar.searchVal,type:n}).then((function(t){e.data=e.data.concat(t[n].data.map((function(t){return t.title=t.mingcheng,t.author=t.chaodai+"/"+t.zuozhe,t.summary=t.zhaiyao,t}))),e.page=e.page+1,e.total=t[n].total,0===e.total||e.data.length>=e.total?e.isAll=!0:e.isAll=!1})).finally((function(t){e.loading=!1})))}}},onLoad:function(){this.tabIndex=0;var t=getApp().globalData.bgc;this.bgc=t[Math.floor(t.length*Math.random())]}};e.default=l}).call(this,n("543d")["default"])},"59b1":function(t,e,n){"use strict";n.r(e);var a=n("0dd2"),o=n("5e0d");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("efe8");var r,s=n("f0c5"),c=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"1f22b351",null,!1,a["a"],r);e["default"]=c.exports},"5e0d":function(t,e,n){"use strict";n.r(e);var a=n("0ffa"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},6843:function(t,e,n){"use strict";(function(t){n("4739");a(n("66fd"));var e=a(n("59b1"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"835d":function(t,e,n){},efe8:function(t,e,n){"use strict";var a=n("835d"),o=n.n(a);o.a}},[["6843","common/runtime","common/vendor"]]]);